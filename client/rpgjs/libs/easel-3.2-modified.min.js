/*
* --BitmapSequence.js modified--
* -- Text.js modified --
*
* Point by Grant Skinner. Dec 5, 2010
* Visit http://easeljs.com/ for documentation, updates and examples.
*
*
* Copyright (c) 2010 Grant Skinner
* 
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
* 
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/

(function(a){var c=function(h,f,j,i,g,e){this.initialize(h,f,j,i,g,e)};var b=c.prototype;c.identity=null;c.DEG_TO_RAD=Math.PI/180;b.a=1;b.b=0;b.c=0;b.d=1;b.tx=0;b.ty=0;b.alpha=1;b.shadow=null;b.compositeOperation=null;b.initialize=function(h,f,j,i,g,e){if(h!=null){this.a=h}this.b=f||0;this.c=j||0;if(i!=null){this.d=i}this.tx=g||0;this.ty=e||0};b.prepend=function(m,l,k,j,i,g){var f=this.tx;if(m!=1||l!=0||k!=0||j!=1){var e=this.a;var h=this.c;this.a=e*m+this.b*k;this.b=e*l+this.b*j;this.c=h*m+this.d*k;this.d=h*l+this.d*j}this.tx=f*m+this.ty*k+i;this.ty=f*l+this.ty*j+g};b.append=function(n,l,k,j,i,g){var f=this.a;var m=this.b;var h=this.c;var e=this.d;this.a=n*f+l*h;this.b=n*m+l*e;this.c=k*f+j*h;this.d=k*m+j*e;this.tx=i*f+g*h+this.tx;this.ty=i*m+g*e+this.ty};b.prependMatrix=function(d){this.prepend(d.a,d.b,d.c,d.d,d.tx,d.ty);this.prependProperties(d.alpha,d.shadow,d.compositeOperation)};b.appendMatrix=function(d){this.append(d.a,d.b,d.c,d.d,d.tx,d.ty);this.appendProperties(d.alpha,d.shadow,d.compositeOperation)};b.prependTransform=function(j,h,m,l,o,k,i,f,e){if(o%360){var d=o*c.DEG_TO_RAD;var n=Math.cos(d);var g=Math.sin(d)}else{n=1;g=0}if(f||e){this.tx-=f;this.ty-=e}if(k||i){k*=c.DEG_TO_RAD;i*=c.DEG_TO_RAD;this.prepend(n*m,g*m,-g*l,n*l,0,0);this.prepend(Math.cos(i),Math.sin(i),-Math.sin(k),Math.cos(k),j,h)}else{this.prepend(n*m,g*m,-g*l,n*l,j,h)}};b.appendTransform=function(j,h,m,l,o,k,i,f,e){if(o%360){var d=o*c.DEG_TO_RAD;var n=Math.cos(d);var g=Math.sin(d)}else{n=1;g=0}if(k||i){k*=c.DEG_TO_RAD;i*=c.DEG_TO_RAD;this.append(Math.cos(i),Math.sin(i),-Math.sin(k),Math.cos(k),j,h);this.append(n*m,g*m,-g*l,n*l,0,0)}else{this.append(n*m,g*m,-g*l,n*l,j,h)}if(f||e){this.tx-=f*this.a+e*this.c;this.ty-=f*this.b+e*this.d}};b.rotate=function(i){var h=Math.cos(i);var f=Math.sin(i);var e=this.a;var g=this.c;var d=this.tx;this.a=e*h-this.b*f;this.b=e*f+this.b*h;this.c=g*h-this.d*f;this.d=g*f+this.d*h;this.tx=d*h-this.ty*f;this.ty=d*f+this.ty*h};b.skew=function(e,d){e=e*c.DEG_TO_RAD;d=d*c.DEG_TO_RAD;this.append(Math.cos(d),Math.sin(d),-Math.sin(e),Math.cos(e),0,0)};b.scale=function(d,e){this.a*=d;this.d*=e;this.tx*=d;this.ty*=e};b.translate=function(d,e){this.tx+=d;this.ty+=e};b.identity=function(){this.alpha=this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;this.shadow=this.compositeOperation=null};b.invert=function(){var e=this.a;var f=this.b;var g=this.c;var h=this.d;var d=this.tx;var i=e*h-f*g;this.a=h/i;this.b=-f/i;this.c=-g/i;this.d=e/i;this.tx=(g*this.ty-h*d)/i;this.ty=-(e*this.ty-f*d)/i};b.decompose=function(f){if(f==null){f={}}f.x=this.tx;f.y=this.ty;f.scaleX=Math.sqrt(this.a*this.a+this.b*this.b);f.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var e=Math.atan2(-this.c,this.d);var d=Math.atan2(this.b,this.a);if(e==d){f.rotation=d/c.DEG_TO_RAD;if(this.a<0&&this.d>=0){f.rotation+=(f.rotation<=0)?180:-180}f.skewX=f.skewY=0}else{f.skewX=e/c.DEG_TO_RAD;f.skewY=d/c.DEG_TO_RAD}return f};b.reinitialize=function(l,k,j,i,g,f,e,m,h){this.initialize(l,k,j,i,g,f);this.alpha=e||1;this.shadow=m;this.compositeOperation=h;return this};b.appendProperties=function(e,f,d){this.alpha*=e;this.shadow=f||this.shadow;this.compositeOperation=d||this.compositeOperation};b.prependProperties=function(e,f,d){this.alpha*=e;this.shadow=this.shadow||f;this.compositeOperation=this.compositeOperation||d};b.clone=function(){var d=new c(this.a,this.b,this.c,this.d,this.tx,this.ty);d.shadow=this.shadow;d.alpha=this.alpha;d.compositeOperation=this.compositeOperation;return d};b.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"};c.identity=new c(1,0,0,1,0,0);a.Matrix2D=c}(window));(function(b){var a=function(){throw"SpriteSheetUtils cannot be instantiated"};a._workingCanvas=document.createElement("canvas");a._workingContext=a._workingCanvas.getContext("2d");a.flip=function(B,t){var q=B.image;var d=B.frameData;var y=B.frameWidth;var l=B.frameHeight;var o=q.width/y|0;var m=q.height/l|0;var s=o*m;var c={};var D;for(var u in d){D=d[u];if(D instanceof Array){D=D.slice(0)}c[u]=D}var C=[];var F=0;var z=0;for(u in t){var r=t[u];D=d[r[0]];if(D==null){continue}if(D instanceof Array){var h=D[0];var g=D[1];if(g==null){g=h}}else{h=g=D}C[z]=u;C[z+1]=h;C[z+2]=g;F+=g-h+1;z+=4}var f=a._workingCanvas;f.width=q.width;f.height=Math.ceil(m+F/o)*l;var w=a._workingContext;w.drawImage(q,0,0,o*y,m*l,0,0,o*y,m*l);var p=s-1;for(z=0;z<C.length;z+=4){u=C[z];h=C[z+1];g=C[z+2];r=t[u];var v=r[1]?-1:1;var k=r[2]?-1:1;var e=v==-1?y:0;var A=k==-1?l:0;for(var x=h;x<=g;x++){p++;w.save();w.translate((p%o)*y+e,(p/o|0)*l+A);w.scale(v,k);w.drawImage(q,(x%o)*y,(x/o|0)*l,y,l,0,0,y,l);w.restore()}c[u]=[p-(g-h),p,r[3]]}var E=new Image();E.src=f.toDataURL("image/png");return new SpriteSheet((E.width>0)?E:f,y,l,c)};a.frameDataToString=function(l){var j="";var k=0;var f=0;var i=0;var g,h;for(var d in l){i++;g=l[d];if(g instanceof Array){var c=g[0];var e=g[1];if(e==null){e=c}h=g[2];if(h==null){h=d}}else{c=e=g;h=d}j+="\n\t"+d+", start="+c+", end="+e+", next="+h;if(h==false){j+=" (stop)"}else{if(h==d){j+=" (loop)"}}if(e>k){k=e}if(c<f){f=c}}j=i+" sequences, min="+f+", max="+k+j;return j};a.extractFrame=function(k,c){var e=k.image;var j=k.frameWidth;var f=k.frameHeight;var i=e.width/j|0;if(isNaN(c)){var h=k.frameData[c];if(h instanceof Array){c=h[0]}else{c=h}}var d=a._workingCanvas;d.width=j;d.height=f;a._workingContext.drawImage(e,(c%i)*j,(c/i|0)*f,j,f,0,0,j,f);var g=new Image();g.src=d.toDataURL("image/png");return g};b.SpriteSheetUtils=a}(window));(function(a){var b=function(){throw"Ticker cannot be instantiated."};b._listeners=[];b._pauseable=[];b._paused=false;b._inited=false;b._startTime=0;b._pausedTime=0;b._ticks=0;b._pausedTickers=0;b._interval=50;b._intervalID=null;b._lastTime=0;b._times=[];b.addListener=function(c,d){if(!b._inited){b._inited=true;b._startTime=b._getTime();b._times.push(0);b.setInterval(b._interval)}this.removeListener(c);b._pauseable[b._listeners.length]=(d==null)?true:d;b._listeners.push(c)};b.removeListener=function(d){if(b._listeners==null){return}var c=b._listeners.indexOf(d);if(c!=-1){b._listeners.splice(c,1);b._pauseable.splice(c,1)}};b.removeAllListeners=function(){b._listeners=[];b._pauseable=[]};b.setInterval=function(c){if(b._intervalID!=null){clearInterval(b._intervalID)}b._lastTime=b.getTime(false);b._interval=c;b._intervalID=setInterval(b._tick,c)};b.getInterval=function(){return b._interval};b.getFPS=function(){return 1000/b._interval};b.setFPS=function(c){b.setInterval(1000/c)};b.getMeasuredFPS=function(c){if(b._times.length<2){return -1}if(c==null){c=b.getFPS()>>1}c=Math.min(b._times.length-1,c);return 1000/((b._times[0]-b._times[c])/c)};b.setPaused=function(c){b._paused=c};b.getPaused=function(){return b._paused};b.getTime=function(c){return b._getTime()-b._startTime-(c?b._pausedTime:0)};b.getTicks=function(c){return b._ticks-(c?b._pausedTickers:0)};b._tick=function(){b._ticks++;var f=b.getTime(false);var m=f-b._lastTime;var k=b._paused;if(k){b._pausedTickers++;b._pausedTime+=m}b._lastTime=f;var c=b._pauseable;var j=b._listeners.slice();var g=j?j.length:0;for(var h=0;h<g;h++){var d=c[h];var e=j[h];if(e==null||(k&&d)||e.tick==null){continue}e.tick(m)}b._times.unshift(f);if(b._times.length>100){b._times.pop()}};b._getTime=function(){return new Date().getTime()};a.Ticker=b}(window));(function(b){var a=function(){throw"UID cannot be instantiated"};a._nextID=0;a.get=function(){return a._nextID++};b.UID=a}(window));(function(b){var a=function(){this.initialize()};var c=a.prototype;a.suppressCrossDomainErrors=false;a._hitTestCanvas=document.createElement("canvas");a._hitTestCanvas.width=a._hitTestCanvas.height=1;a._hitTestContext=a._hitTestCanvas.getContext("2d");c.alpha=1;c.cacheCanvas=null;c.id=-1;c.mouseEnabled=true;c.name=null;c.parent=null;c.regX=0;c.regY=0;c.rotation=0;c.scaleX=1;c.scaleY=1;c.skewX=0;c.skewY=0;c.shadow=null;c.visible=true;c.x=0;c.y=0;c.compositeOperation=null;c.snapToPixel=false;c.onPress=null;c.onClick=null;c.onDoubleClick=null;c.onMouseOver=null;c.onMouseOut=null;c.tick=null;c.filters=null;c._cacheOffsetX=0;c._cacheOffsetY=0;c._matrix=null;c.initialize=function(){this.id=UID.get();this._matrix=new Matrix2D()};c.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0};c.draw=function(d,e){if(e||!this.cacheCanvas){return false}d.drawImage(this.cacheCanvas,this._cacheOffsetX,this._cacheOffsetY);return true};c.cache=function(e,h,g,d){if(this.cacheCanvas==null){this.cacheCanvas=document.createElement("canvas")}var f=this.cacheCanvas.getContext("2d");this.cacheCanvas.width=g;this.cacheCanvas.height=d;f.setTransform(1,0,0,1,-e,-h);f.clearRect(0,0,g+1,d+1);this.draw(f,true);this._cacheOffsetX=e;this._cacheOffsetY=h;this._applyFilters()};c.updateCache=function(e){if(this.cacheCanvas==null){throw"cache() must be called before updateCache()"}var d=this.cacheCanvas.getContext("2d");d.setTransform(1,0,0,1,-this._cacheOffsetX,-this._cacheOffsetY);if(!e){d.clearRect(0,0,this.cacheCanvas.width+1,this.cacheCanvas.height+1)}else{d.globalCompositeOperation=e}this.draw(d,true);if(e){d.globalCompositeOperation="source-over"}this._applyFilters()};c.uncache=function(){this.cacheCanvas=null;this._cacheOffsetX=this._cacheOffsetY=0};c.getStage=function(){var d=this;while(d.parent){d=d.parent}if(d instanceof Stage){return d}return null};c.localToGlobal=function(d,f){var e=this.getConcatenatedMatrix(this._matrix);if(e==null){return null}e.append(1,0,0,1,d,f);return new Point(e.tx,e.ty)};c.globalToLocal=function(d,f){var e=this.getConcatenatedMatrix(this._matrix);if(e==null){return null}e.invert();e.append(1,0,0,1,d,f);return new Point(e.tx,e.ty)};c.localToLocal=function(d,g,f){var e=this.localToGlobal(d,g);return f.globalToLocal(e.x,e.y)};c.setTransform=function(h,f,k,j,l,i,g,e,d){this.x=h||0;this.y=f||0;this.scaleX=k==null?1:k;this.scaleY=j==null?1:j;this.rotation=l||0;this.skewX=i||0;this.skewY=g||0;this.regX=e||0;this.regY=d||0};c.getConcatenatedMatrix=function(d){if(d){d.identity()}else{d=new Matrix2D()}var e=this;while(e!=null){d.prependTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY);d.prependProperties(e.alpha,e.shadow,e.compositeOperation);e=e.parent}return d};c.hitTest=function(d,h){var e=a._hitTestContext;var f=a._hitTestCanvas;e.setTransform(1,0,0,1,-d,-h);this.draw(e);var g=this._testHit(e);f.width=0;f.width=1;return g};c.clone=function(){var d=new a();this.cloneProps(d);return d};c.toString=function(){return"[DisplayObject (name="+this.name+")]"};c.cloneProps=function(d){d.alpha=this.alpha;d.name=this.name;d.regX=this.regX;d.regY=this.regY;d.rotation=this.rotation;d.scaleX=this.scaleX;d.scaleY=this.scaleY;d.shadow=this.shadow;d.skewX=this.skewX;d.skewY=this.skewY;d.visible=this.visible;d.x=this.x;d.y=this.y;d.mouseEnabled=this.mouseEnabled;d.compositeOperation=this.compositeOperation};c.applyShadow=function(d,e){e=e||Shadow.identity;d.shadowColor=e.color;d.shadowOffsetX=e.offsetX;d.shadowOffsetY=e.offsetY;d.shadowBlur=e.blur};c._testHit=function(d){try{var f=d.getImageData(0,0,1,1).data[3]>1}catch(g){if(!a.suppressCrossDomainErrors){throw"An error has occured. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images."}}return f};c._applyFilters=function(){if(!this.filters||this.filters.length==0||!this.cacheCanvas){return}var f=this.filters.length;var e=this.cacheCanvas.getContext("2d");var d=this.cacheCanvas.width;var j=this.cacheCanvas.height;for(var g=0;g<f;g++){this.filters[g].applyFilter(e,0,0,d,j)}};b.DisplayObject=a}(window));(function(b){var a=function(d){this.initialize(d)};var c=a.prototype=new DisplayObject();c.image=null;c.snapToPixel=true;c.DisplayObject_initialize=c.initialize;c.initialize=function(d){this.DisplayObject_initialize();if(typeof d=="string"){this.image=new Image();this.image.src=d}else{this.image=d}};c.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.image&&(this.image.complete||this.image.getContext)};c.DisplayObject_draw=c.draw;c.draw=function(d,e){if(this.DisplayObject_draw(d,e)){return true}d.drawImage(this.image,0,0);return true};c.clone=function(){var d=new a(this.image);this.cloneProps(d);return d};c.toString=function(){return"[Bitmap (name="+this.name+")]"};b.Bitmap=a}(window));(function(b){var a=function(){this.initialize()};var c=a.prototype=new DisplayObject();c.children=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(){this.DisplayObject_initialize();this.children=[]};c.isVisible=function(){return this.visible&&this.alpha>0&&this.children.length&&this.scaleX!=0&&this.scaleY!=0};c.DisplayObject_draw=c.draw;c.draw=function(o,d,j){var h=Stage._snapToPixelEnabled;if(this.DisplayObject_draw(o,d)){return true}j=j||this._matrix.reinitialize(1,0,0,1,0,0,this.alpha,this.shadow,this.compositeOperation);var g=this.children.length;var m=this.children.slice(0);for(var k=0;k<g;k++){var f=m[k];if(!f.isVisible()){continue}var n=false;var e=f._matrix.reinitialize(j.a,j.b,j.c,j.d,j.tx,j.ty,j.alpha,j.shadow,j.compositeOperation);e.appendTransform(f.x,f.y,f.scaleX,f.scaleY,f.rotation,f.skewX,f.skewY,f.regX,f.regY);e.appendProperties(f.alpha,f.shadow,f.compositeOperation);if(!(f instanceof a&&f.cacheCanvas==null)){if(h&&f.snapToPixel&&e.a==1&&e.b==0&&e.c==0&&e.d==1){o.setTransform(e.a,e.b,e.c,e.d,e.tx+0.5|0,e.ty+0.5|0)}else{o.setTransform(e.a,e.b,e.c,e.d,e.tx,e.ty)}o.globalAlpha=e.alpha;o.globalCompositeOperation=e.compositeOperation||"source-over";if(n=e.shadow){this.applyShadow(o,n)}}f.draw(o,false,e);if(n){this.applyShadow(o)}}return true};c.addChild=function(f){var d=arguments.length;if(d>1){for(var e=0;e<d;e++){this.addChild(arguments[e])}return arguments[d-1]}if(f.parent){f.parent.removeChild(f)}f.parent=this;this.children.push(f);return f};c.addChildAt=function(g,e){var d=arguments.length;if(d>2){e=arguments[f-1];for(var f=0;f<d-1;f++){this.addChildAt(arguments[f],e+f)}return arguments[d-2]}if(g.parent){g.parent.removeChild(g)}g.parent=this;this.children.splice(e,0,g);return g};c.removeChild=function(g){var d=arguments.length;if(d>1){var f=true;for(var e=0;e<d;e++){f=f&&this.removeChild(arguments[e])}return f}return this.removeChildAt(this.children.indexOf(g))};c.removeChildAt=function(f){var e=arguments.length;if(e>1){var d=[];for(var g=0;g<e;g++){d[g]=arguments[g]}d.sort(function(k,i){return i-k});var h=true;for(var g=0;g<e;g++){h=h&&this.removeChildAt(d[g])}return h}if(f<0||f>this.children.length-1){return false}var j=this.children[f];if(j!=null){j.parent=null}this.children.splice(f,1);return true};c.removeAllChildren=function(){while(this.children.length){this.removeChildAt(0)}};c.getChildAt=function(d){return this.children[d]};c.sortChildren=function(d){this.children.sort(d)};c.getChildIndex=function(d){return this.children.indexOf(d)};c.getNumChildren=function(){return this.children.length};c.contains=function(d){while(d){if(d==this){return true}d=d.parent}return false};c.hitTest=function(d,e){return(this.getObjectUnderPoint(d,e)!=null)};c.getObjectsUnderPoint=function(e,g){var d=[];var f=this.localToGlobal(e,g);this._getObjectsUnderPoint(f.x,f.y,d);return d};c.getObjectUnderPoint=function(d,f){var e=this.localToGlobal(d,f);return this._getObjectsUnderPoint(e.x,e.y)};c.clone=function(f){var h=new a();this.cloneProps(h);if(f){var d=h.children=[];for(var g=0,e=this.children.length;g<e;g++){var j=this.children[g].clone(f);j.parent=h;d.push(j)}}return h};c.toString=function(){return"[Container (name="+this.name+")]"};c._tick=function(){for(var d=this.children.length-1;d>=0;d--){var e=this.children[d];if(e._tick){e._tick()}if(e.tick){e.tick()}}};c._getObjectsUnderPoint=function(n,m,j,q){var o=DisplayObject._hitTestContext;var f=DisplayObject._hitTestCanvas;var d=this._matrix;var k=(q&1&&(this.onPress||this.onClick||this.onDoubleClick))||(q&2&&(this.onMouseOver||this.onMouseOut));if(this.cacheCanvas){this.getConcatenatedMatrix(d);o.setTransform(d.a,d.b,d.c,d.d,d.tx-n,d.ty-m);o.globalAlpha=d.alpha;this.draw(o);if(this._testHit(o)){f.width=0;f.width=1;if(k){return this}}else{return null}}var g=this.children.length;for(var h=g-1;h>=0;h--){var e=this.children[h];if(!e.isVisible()||!e.mouseEnabled){continue}if(e instanceof a){var p;if(k){p=e._getObjectsUnderPoint(n,m);if(p){return this}}else{p=e._getObjectsUnderPoint(n,m,j,q);if(!j&&p){return p}}}else{if(!q||k||(q&1&&(e.onPress||e.onClick||e.onDoubleClick))||(q&2&&(e.onMouseOver||e.onMouseOut))){e.getConcatenatedMatrix(d);o.setTransform(d.a,d.b,d.c,d.d,d.tx-n,d.ty-m);o.globalAlpha=d.alpha;e.draw(o);if(!this._testHit(o)){continue}f.width=0;f.width=1;if(k){return this}else{if(j){j.push(e)}else{return e}}}}}return null};b.Container=a}(window));(function(a){var c=function(d){this.initialize(d)};var b=c.prototype=new Container();c._snapToPixelEnabled=false;b.autoClear=true;b.canvas=null;b.mouseX=null;b.mouseY=null;b.onMouseMove=null;b.onMouseUp=null;b.onMouseDown=null;b.snapToPixelEnabled=false;b.mouseInBounds=false;b.tickOnUpdate=true;b._activeMouseEvent=null;b._activeMouseTarget=null;b._mouseOverIntervalID=null;b._mouseOverX=0;b._mouseOverY=0;b._mouseOverTarget=null;b.Container_initialize=b.initialize;b.initialize=function(d){this.Container_initialize();this.canvas=d;this._enableMouseEvents(true)};b.update=function(){if(!this.canvas){return}if(this.autoClear){this.clear()}c._snapToPixelEnabled=this.snapToPixelEnabled;if(this.tickOnUpdate){this._tick()}this.draw(this.canvas.getContext("2d"),false,this.getConcatenatedMatrix(this._matrix))};b.tick=b.update;b.clear=function(){if(!this.canvas){return}var d=this.canvas.getContext("2d");d.setTransform(1,0,0,1,0,0);d.clearRect(0,0,this.canvas.width,this.canvas.height)};b.toDataURL=function(f,l){if(!l){l="image/png"}var e=this.canvas.getContext("2d");var d=this.canvas.width;var g=this.canvas.height;var j;if(f){j=e.getImageData(0,0,d,g);var i=e.globalCompositeOperation;e.globalCompositeOperation="destination-over";e.fillStyle=f;e.fillRect(0,0,d,g)}var k=this.canvas.toDataURL(l);if(f){e.clearRect(0,0,d,g);e.putImageData(j,0,0);e.globalCompositeOperation=i}return k};b.enableMouseOver=function(d){if(this._mouseOverIntervalID){clearInterval(this._mouseOverIntervalID);this._mouseOverIntervalID=null}if(d<=0){return}var e=this;this._mouseOverIntervalID=setInterval(function(){e._testMouseOver()},1000/Math.min(50,d));this._mouseOverX=NaN;this._mouseOverTarget=null};b.clone=function(){var d=new c(null);this.cloneProps(d);return d};b.toString=function(){return"[Stage (name="+this.name+")]"};b._enableMouseEvents=function(){var e=this;var d=a.addEventListener?a:document;d.addEventListener("mouseup",function(f){e._handleMouseUp(f)},false);d.addEventListener("mousemove",function(f){e._handleMouseMove(f)},false);d.addEventListener("dblclick",function(f){e._handleDoubleClick(f)},false);this.canvas.addEventListener("mousedown",function(f){e._handleMouseDown(f)},false)};b._handleMouseMove=function(g){if(!this.canvas){this.mouseX=this.mouseY=null;return}if(!g){g=a.event}var d=this.mouseInBounds;this._updateMousePosition(g.pageX,g.pageY);if(!d&&!this.mouseInBounds){return}var f=new MouseEvent("onMouseMove",this.mouseX,this.mouseY,this,g);if(this.onMouseMove){this.onMouseMove(f)}if(this._activeMouseEvent&&this._activeMouseEvent.onMouseMove){this._activeMouseEvent.onMouseMove(f)}};b._updateMousePosition=function(e,d){var f=this.canvas;do{e-=f.offsetLeft;d-=f.offsetTop}while(f=f.offsetParent);this.mouseInBounds=(e>=0&&d>=0&&e<this.canvas.width&&d<this.canvas.height);if(this.mouseInBounds){this.mouseX=e;this.mouseY=d}};b._handleMouseUp=function(f){var d=new MouseEvent("onMouseUp",this.mouseX,this.mouseY,this,f);if(this.onMouseUp){this.onMouseUp(d)}if(this._activeMouseEvent&&this._activeMouseEvent.onMouseUp){this._activeMouseEvent.onMouseUp(d)}if(this._activeMouseTarget&&this._activeMouseTarget.onClick&&this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,true,(this._mouseOverIntervalID?3:1))==this._activeMouseTarget){this._activeMouseTarget.onClick(new MouseEvent("onClick",this.mouseX,this.mouseY,this._activeMouseTarget,f))}this._activeMouseEvent=this._activeMouseTarget=null};b._handleMouseDown=function(g){if(this.onMouseDown){this.onMouseDown(new MouseEvent("onMouseDown",this.mouseX,this.mouseY,this,g))}var f=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,(this._mouseOverIntervalID?3:1));if(f){if(f.onPress instanceof Function){var d=new MouseEvent("onPress",this.mouseX,this.mouseY,f,g);f.onPress(d);if(d.onMouseMove||d.onMouseUp){this._activeMouseEvent=d}}this._activeMouseTarget=f}};b._testMouseOver=function(){if(this.mouseX==this._mouseOverX&&this.mouseY==this._mouseOverY&&this.mouseInBounds){return}var d=null;if(this.mouseInBounds){d=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,3);this._mouseOverX=this.mouseX;this._mouseOverY=this.mouseY}if(this._mouseOverTarget!=d){if(this._mouseOverTarget&&this._mouseOverTarget.onMouseOut){this._mouseOverTarget.onMouseOut(new MouseEvent("onMouseOut",this.mouseX,this.mouseY,this._mouseOverTarget))}if(d&&d.onMouseOver){d.onMouseOver(new MouseEvent("onMouseOver",this.mouseX,this.mouseY,d))}this._mouseOverTarget=d}};b._handleDoubleClick=function(f){if(this.onDoubleClick){this.onDoubleClick(new MouseEvent("onDoubleClick",this.mouseX,this.mouseY,this,f))}var d=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,(this._mouseOverIntervalID?3:1));if(d){if(d.onDoubleClick instanceof Function){d.onDoubleClick(new MouseEvent("onPress",this.mouseX,this.mouseY,d,f))}}};a.Stage=c}(window));(function(a){var c=function(d){this.initialize(d)};var b=c.prototype=new DisplayObject();b.graphics=null;b.DisplayObject_initialize=b.initialize;b.initialize=function(d){this.DisplayObject_initialize();this.graphics=d?d:new Graphics()};b.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.graphics};b.DisplayObject_draw=b.draw;b.draw=function(d,e){if(this.DisplayObject_draw(d,e)){return true}this.graphics.draw(d);return true};b.clone=function(d){var e=new c((d&&this.graphics)?this.graphics.clone():this.graphics);this.cloneProps(e);return e};b.toString=function(){return"[Shape (name="+this.name+")]"};a.Shape=c}(window));(function(b){function c(e,g){this.f=e;this.params=g}c.prototype.exec=function(e){this.f.apply(e,this.params)};var a=function(){this.initialize()};var d=a.prototype;a.getRGB=function(h,f,e,i){if(h!=null&&e==null){i=f;e=h&255;f=h>>8&255;h=h>>16&255}if(i==null){return"rgb("+h+","+f+","+e+")"}else{return"rgba("+h+","+f+","+e+","+i+")"}};a.getHSL=function(e,f,h,g){if(g==null){return"hsl("+(e%360)+","+f+"%,"+h+"%)"}else{return"hsla("+(e%360)+","+f+"%,"+h+"%,"+g+")"}};a.STROKE_CAPS_MAP=["butt","round","square"];a.STROKE_JOINTS_MAP=["miter","round","bevel"];a._ctx=document.createElement("canvas").getContext("2d");a.beginCmd=new c(a._ctx.beginPath,[]);a.fillCmd=new c(a._ctx.fill,[]);a.strokeCmd=new c(a._ctx.stroke,[]);d._strokeInstructions=null;d._strokeStyleInstructions=null;d._fillInstructions=null;d._instructions=null;d._oldInstructions=null;d._activeInstructions=null;d._active=false;d._dirty=false;d.initialize=function(){this.clear();this._ctx=a._ctx};d.draw=function(g){if(this._dirty){this._updateInstructions()}var f=this._instructions;for(var h=0,e=f.length;h<e;h++){f[h].exec(g)}};d.moveTo=function(e,f){this._activeInstructions.push(new c(this._ctx.moveTo,[e,f]));return this};d.lineTo=function(e,f){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.lineTo,[e,f]));return this};d.arcTo=function(g,i,f,h,e){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.arcTo,[g,i,f,h,e]));return this};d.arc=function(f,j,e,h,g,i){this._dirty=this._active=true;if(i==null){i=false}this._activeInstructions.push(new c(this._ctx.arc,[f,j,e,h,g,i]));return this};d.quadraticCurveTo=function(g,f,e,h){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.quadraticCurveTo,[g,f,e,h]));return this};d.bezierCurveTo=function(g,f,i,h,e,j){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.bezierCurveTo,[g,f,i,h,e,j]));return this};d.rect=function(e,i,f,g){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.rect,[e,i,f,g]));return this};d.closePath=function(){if(this._active){this._dirty=true;this._activeInstructions.push(new c(this._ctx.closePath,[]))}return this};d.clear=function(){this._instructions=[];this._oldInstructions=[];this._activeInstructions=[];this._strokeStyleInstructions=this._strokeInstructions=this._fillInstructions=null;this._active=this._dirty=false;return this};d.beginFill=function(e){if(this._active){this._newPath()}this._fillInstructions=e?[new c(this._setProp,["fillStyle",e])]:null;return this};d.beginLinearGradientFill=function(e,m,h,p,f,n){if(this._active){this._newPath()}var g=this._ctx.createLinearGradient(h,p,f,n);for(var k=0,j=e.length;k<j;k++){g.addColorStop(m[k],e[k])}this._fillInstructions=[new c(this._setProp,["fillStyle",g])];return this};d.beginRadialGradientFill=function(e,p,h,r,k,f,q,j){if(this._active){this._newPath()}var g=this._ctx.createRadialGradient(h,r,k,f,q,j);for(var n=0,m=e.length;n<m;n++){g.addColorStop(p[n],e[n])}this._fillInstructions=[new c(this._setProp,["fillStyle",g])];return this};d.beginBitmapFill=function(f,e){if(this._active){this._newPath()}e=e||"";var g=this._ctx.createPattern(f,e);this._fillInstructions=[new c(this._setProp,["fillStyle",g])];return this};d.endFill=function(){this.beginFill(null);return this};d.setStrokeStyle=function(g,h,e,f){if(this._active){this._newPath()}this._strokeStyleInstructions=[new c(this._setProp,["lineWidth",(g==null?"1":g)]),new c(this._setProp,["lineCap",(h==null?"butt":(isNaN(h)?h:a.STROKE_CAPS_MAP[h]))]),new c(this._setProp,["lineJoin",(e==null?"miter":(isNaN(e)?e:a.STROKE_JOINTS_MAP[e]))]),new c(this._setProp,["miterLimit",(f==null?"10":f)])];return this};d.beginStroke=function(e){if(this._active){this._newPath()}this._strokeInstructions=e?[new c(this._setProp,["strokeStyle",e])]:null;return this};d.beginLinearGradientStroke=function(e,m,h,p,f,n){if(this._active){this._newPath()}var g=this._ctx.createLinearGradient(h,p,f,n);for(var k=0,j=e.length;k<j;k++){g.addColorStop(m[k],e[k])}this._strokeInstructions=[new c(this._setProp,["strokeStyle",g])];return this};d.beginRadialGradientStroke=function(e,p,h,r,k,f,q,j){if(this._active){this._newPath()}var g=this._ctx.createRadialGradient(h,r,k,f,q,j);for(var n=0,m=e.length;n<m;n++){g.addColorStop(p[n],e[n])}this._strokeInstructions=[new c(this._setProp,["strokeStyle",g])];return this};d.beginBitmapStroke=function(f,e){if(this._active){this._newPath()}e=e||"";var g=this._ctx.createPattern(f,e);this._strokeInstructions=[new c(this._setProp,["strokeStyle",g])];return this};d.endStroke=function(){this.beginStroke(null);return this};d.curveTo=d.quadraticCurveTo;d.drawRect=d.rect;d.drawRoundRect=function(f,j,g,i,e){this.drawRoundRectComplex(f,j,g,i,e,e,e,e);return this};d.drawRoundRectComplex=function(f,m,g,j,l,i,e,k){this._dirty=this._active=true;this._activeInstructions.push(new c(this._ctx.moveTo,[f+l,m]),new c(this._ctx.lineTo,[f+g-i,m]),new c(this._ctx.arc,[f+g-i,m+i,i,(-Math.PI/2),0,false]),new c(this._ctx.lineTo,[f+g,m+j-e]),new c(this._ctx.arc,[f+g-e,m+j-e,e,0,Math.PI/2,false]),new c(this._ctx.lineTo,[f+k,m+j]),new c(this._ctx.arc,[f+k,m+j-k,k,Math.PI/2,Math.PI,false]),new c(this._ctx.lineTo,[f,m+l]),new c(this._ctx.arc,[f+l,m+l,l,Math.PI,Math.PI*3/2,false]));return this};d.drawCircle=function(f,g,e){this.arc(f,g,e,0,Math.PI*2);return this};d.drawEllipse=function(o,n,p,j){this._dirty=this._active=true;var i=0.5522848;var g=(p/2)*i;var e=(j/2)*i;var q=o+p;var m=n+j;var l=o+p/2;var f=n+j/2;this._activeInstructions.push(new c(this._ctx.moveTo,[o,f]),new c(this._ctx.bezierCurveTo,[o,f-e,l-g,n,l,n]),new c(this._ctx.bezierCurveTo,[l+g,n,q,f-e,q,f]),new c(this._ctx.bezierCurveTo,[q,f+e,l+g,m,l,m]),new c(this._ctx.bezierCurveTo,[l-g,m,o,f+e,o,f]));return this};d.drawPolyStar=function(f,m,e,j,k,l){this._dirty=this._active=true;if(k==null){k=0}k=1-k;if(l==null){l=0}else{l/=180/Math.PI}var g=Math.PI/j;this._activeInstructions.push(new c(this._ctx.moveTo,[f+Math.cos(l)*e,m+Math.sin(l)*e]));for(var h=0;h<j;h++){l+=g;if(k!=1){this._activeInstructions.push(new c(this._ctx.lineTo,[f+Math.cos(l)*e*k,m+Math.sin(l)*e*k]))}l+=g;this._activeInstructions.push(new c(this._ctx.lineTo,[f+Math.cos(l)*e,m+Math.sin(l)*e]))}return this};d.clone=function(){var e=new a();e._instructions=this._instructions.slice();e._activeInstructions=this._activeInstructions.slice();e._oldInstructions=this._oldInstructions.slice();if(this._fillInstructions){e._fillInstructions=this._fillInstructions.slice()}if(this._strokeInstructions){e._strokeInstructions=this._strokeInstructions.slice()}if(this._strokeStyleInstructions){e._strokeStyleInstructions=this._strokeStyleInstructions.slice()}e._active=this._active;e._dirty=this._dirty;return e};d.toString=function(){return"[Graphics]"};d.mt=d.moveTo;d.lt=d.lineTo;d.at=d.arcTo;d.bt=d.bezierCurveTo;d.qt=d.quadraticCurveTo;d.a=d.arc;d.r=d.rect;d.cp=d.closePath;d.c=d.clear;d.f=d.beginFill;d.lf=d.beginLinearGradientFill;d.rf=d.beginRadialGradientFill;d.bf=d.beginBitmapFill;d.ef=d.endFill;d.ss=d.setStrokeStyle;d.s=d.beginStroke;d.ls=d.beginLinearGradientStroke;d.rs=d.beginRadialGradientStroke;d.bs=d.beginBitmapStroke;d.es=d.endStroke;d.dr=d.drawRect;d.rr=d.drawRoundRect;d.rc=d.drawRoundRectComplex;d.dc=d.drawCircle;d.de=d.drawEllipse;d.dp=d.drawPolyStar;d._updateInstructions=function(){this._instructions=this._oldInstructions.slice();this._instructions.push(a.beginCmd);if(this._fillInstructions){this._instructions.push.apply(this._instructions,this._fillInstructions)}if(this._strokeInstructions){this._instructions.push.apply(this._instructions,this._strokeInstructions);if(this._strokeStyleInstructions){this._instructions.push.apply(this._instructions,this._strokeStyleInstructions)}}this._instructions.push.apply(this._instructions,this._activeInstructions);if(this._fillInstructions){this._instructions.push(a.fillCmd)}if(this._strokeInstructions){this._instructions.push(a.strokeCmd)}};d._newPath=function(){if(this._dirty){this._updateInstructions()}this._oldInstructions=this._instructions;this._activeInstructions=[];this._active=this._dirty=false};d._setProp=function(e,f){this[e]=f};b.Graphics=a}(window));(function(a){BitmapSequence=function(c){this.initialize(c)};var b=BitmapSequence.prototype=new DisplayObject();b.callback=null;b.currentFrame=-1;b.waitFrame=0;b.currentWaitFrame=0;b.arrayFrames;b.arrayFramesPosition=0;b.nbSequenceToPlay=-1;b.nbSequencePlayed=0;b.currentSequence=null;b.currentEndFrame=null;b.currentStartFrame=null;b.nextSequence=null;b.paused=false;b.spriteSheet=null;b.snapToPixel=true;b.DisplayObject_initialize=b.initialize;b.initialize=function(c){this.DisplayObject_initialize();this.spriteSheet=c};b.isVisible=function(){var c=this.spriteSheet?this.spriteSheet.image:null;return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&c&&this.currentFrame>=0&&(c.complete||c.getContext)};b.DisplayObject_draw=b.draw;b.draw=function(j,c){if(this.DisplayObject_draw(j,c)){return true}var e=this.spriteSheet.image;var h=this.spriteSheet.frameWidth;var f=this.spriteSheet.frameHeight;var g=e.width/h|0;var l=e.height/f|0;if(this.currentEndFrame!=null){if(this.currentFrame>this.currentEndFrame){this.nbSequencePlayed++;if(this.nextSequence&&(this.nbSequenceToPlay==-1||this.nbSequenceToPlay>this.nbSequencePlayed)){this._goto(this.nextSequence)}else{this.paused=true;this.currentFrame=this.currentEndFrame;this.nbSequencePlayed=0}if(this.callback){this.callback(this)}}}else{var i=this.spriteSheet.totalFrames||g*l;if(this.currentFrame>=i){if(this.spriteSheet.loop){this.currentFrame=0}else{this.currentFrame=i-1;this.paused=true}if(this.callback){this.callback(this)}}}if(this.currentFrame>=0){var d=this.currentFrame%g;var k=this.currentFrame/g|0;j.drawImage(e,h*d,f*k,h,f,0,0,h,f)}return true};b.tick=function(){if(this.currentFrame==-1&&this.spriteSheet.frameData){this.paused=true}if(this.paused){return}if(this.currentWaitFrame==this.waitFrame){if(this.arrayFrames){if(this.arrayFramesPosition>=this.arrayFrames.length){this.arrayFramesPosition=0}this.currentFrame=this.arrayFrames[this.arrayFramesPosition];this.arrayFramesPosition++}else{this.currentFrame++}this.currentWaitFrame=0}this.currentWaitFrame++};b.gotoAndPlay=function(c){this.paused=false;this._goto(c)};b.gotoAndStop=function(c){this.paused=true;this._goto(c)};b.clone=function(){var c=new BitmapSequence(this.spriteSheet);this.cloneProps(c);return c};b.toString=function(){return"[BitmapSequence (name="+this.name+")]"};b.DisplayObject_cloneProps=b.cloneProps;b.cloneProps=function(c){this.DisplayObject_cloneProps(c);c.waitFrame=this.waitFrame;c.arrayFrames=this.arrayFrames;c.callback=this.callback;c.currentFrame=this.currentFrame;c.currentStartFrame=this.currentStartFrame;c.currentEndFrame=this.currentEndFrame;c.currentSequence=this.currentSequence;c.nextSequence=this.nextSequence;c.paused=this.paused;c.frameData=this.frameData};b._goto=function(c){if(isNaN(c)){if(c==this.currentSequence){this.currentFrame=this.currentStartFrame;return}var d=this.spriteSheet.frameData[c];if(d instanceof Array){this.currentFrame=this.currentStartFrame=d[0];this.currentSequence=c;this.currentEndFrame=d[1];if(this.currentEndFrame==null){this.currentEndFrame=this.currentStartFrame}if(this.currentEndFrame==null){this.currentEndFrame=this.currentFrame}this.nextSequence=d[2];if(this.nextSequence==null){this.nextSequence=this.currentSequence}else{if(this.nextSequence==false){this.nextSequence=null}}}else{this.currentSequence=this.nextSequence=null;this.currentEndFrame=this.currentFrame=this.currentStartFrame=d}}else{this.currentSequence=this.nextSequence=this.currentEndFrame=null;this.currentStartFrame=0;this.currentFrame=c}};a.BitmapSequence=BitmapSequence}(window));(function(b){var a=function(g,d,e,f){this.initialize(g,d,e,f)};var c=a.prototype;c.image=null;c.frameWidth=0;c.frameHeight=0;c.frameData=null;c.loop=true;c.totalFrames=0;c.initialize=function(g,d,e,f){this.image=g;this.frameWidth=d;this.frameHeight=e;this.frameData=f};c.toString=function(){return"[SpriteSheet]"};c.clone=function(){var d=new a(this.image,this.frameWidth,this.frameHeight,this.frameData);d.loop=this.loop;d.totalFrames=this.totalFrames;return d};b.SpriteSheet=a}(window));(function(b){var a=function(f,e,d){this.initialize(f,e,d)};var c=a.prototype=new DisplayObject();a._workingContext=document.createElement("canvas").getContext("2d");c.text="";c.font=null;c.color=null;c.textAlign=null;c.textBaseline=null;c.maxWidth=null;c.outline=false;c.lineHeight=null;c.lineWidth=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(f,e,d){this.DisplayObject_initialize();this.text=f;this.font=e;this.color=d?d:"#000"};c.isVisible=function(){return Boolean(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.text!=null&&this.text!="")};c.DisplayObject_draw=c.draw;c.draw=function(q,d){if(this.DisplayObject_draw(q,d)){return true}if(this.outline){q.strokeStyle=this.color}else{q.fillStyle=this.color}q.font=this.font;q.textAlign=this.textAlign?this.textAlign:"start";q.textBaseline=this.textBaseline?this.textBaseline:"alphabetic";var r=String(this.text).split(/(?:\r\n|\r|\n)/);var o=(this.lineHeight==null)?this.getMeasuredLineHeight():this.lineHeight;var n=0;for(var h=0,e=r.length;h<e;h++){var p=q.measureText(r[h]).width;if(this.lineWidth==null||p<this.lineWidth){this._drawTextLine(q,r[h],n);n+=o;continue}var m=r[h].split(/(\s)/);var k=m[0];for(var f=1,g=m.length;f<g;f+=2){if(q.measureText(k+m[f]+m[f+1]).width>this.lineWidth){this._drawTextLine(q,k,n);n+=o;k=m[f+1]}else{k+=m[f]+m[f+1]}}this._drawTextLine(q,k,n);n+=o}return true};c.getMeasuredWidth=function(){return this._getWorkingContext().measureText(this.text).width};c.getMeasuredLineHeight=function(){return this._getWorkingContext().measureText("M").width*1.2};c.clone=function(){var d=new a(this.text,this.font,this.color);this.cloneProps(d);return d};c.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"};c.DisplayObject_cloneProps=c.cloneProps;c.cloneProps=function(d){this.DisplayObject_cloneProps(d);d.textAlign=this.textAlign;d.textBaseline=this.textBaseline;d.maxWidth=this.maxWidth;d.outline=this.outline;d.lineHeight=this.lineHeight;d.lineWidth=this.lineWidth};c._getWorkingContext=function(){var d=a._workingContext;d.font=this.font;d.textAlign=this.textAlign?this.textAlign:"start";d.textBaseline=this.textBaseline?this.textBaseline:"alphabetic";return d};c._drawTextLine=function(d,g,h){var e=this;if(this.outline){f("strokeText")}else{f("fillText")}function f(i){if(e.maxWidth==null){d[i](g,0,h)}else{d[i](g,0,h,e.maxWidth)}}};b.Text=a}(window));(function(a){var c=function(e,d,g,f){this.initialize(e,d,g,f)};var b=c.prototype;c.identity=null;b.color=null;b.offsetX=0;b.offsetY=0;b.blur=0;b.initialize=function(e,d,g,f){this.color=e;this.offsetX=d;this.offsetY=g;this.blur=f};b.toString=function(){return"[Shadow]"};b.clone=function(){return new c(this.color,this.offsetX,this.offsetY,this.blur)};c.identity=new c(null,0,0,0);a.Shadow=c}(window));(function(b){var a=function(d){this.initialize(d)};var c=a.prototype=new DisplayObject();c.htmlElement=null;c._style=null;c.DisplayObject_initialize=c.initialize;c.initialize=function(d){this.DisplayObject_initialize();this.mouseEnabled=false;this.htmlElement=d;if(d){this._style=d.style;this._style.position="absolute";this._style.transformOrigin=this._style.webkitTransformOrigin=this._style.MozTransformOrigin="0px 0px"}};c.isVisible=function(){return this.htmlElement!=null};c.draw=function(d,f){if(this.htmlElement==null){return}var e=this._matrix;var g=this.htmlElement;g.style.opacity=""+e.alpha;g.style.visibility=this.visible?"visible":"hidden";g.style.transform=g.style.webkitTransform=g.style.oTransform=["matrix("+e.a,e.b,e.c,e.d,e.tx,e.ty+")"].join(",");g.style.MozTransform=["matrix("+e.a,e.b,e.c,e.d,e.tx+"px",e.ty+"px)"].join(",");return true};c.cache=function(){};c.uncache=function(){};c.updateCache=function(){};c.hitTest=function(){};c.localToGlobal=function(){};c.globalToLocal=function(){};c.localToLocal=function(){};c.clone=function(){var d=new a();this.cloneProps(d);return d};c.toString=function(){return"[DOMElement (name="+this.name+")]"};c._tick=function(){if(this.htmlElement==null){return}this.htmlElement.style.visibility="hidden"};b.DOMElement=a}(window));(function(b){var a=function(e,g,f,d){this.initialize(e,g,f,d)};var c=a.prototype;c.x=0;c.y=0;c.width=0;c.height=0;c.initialize=function(e,g,f,d){this.x=(e==null?0:e);this.y=(g==null?0:g);this.width=(f==null?0:f);this.height=(d==null?0:d)};c.clone=function(){return new a(this.x,this.y,this.width,this.height)};c.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"};b.Rectangle=a}(window));(function(b){var a=function(d,e){this.initialize(d,e)};var c=a.prototype;c.x=0;c.y=0;c.initialize=function(d,e){this.x=(d==null?0:d);this.y=(e==null?0:e)};c.clone=function(){return new a(this.x,this.y)};c.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"};b.Point=a}(window));(function(b){var a=function(g,f,e,h,d){this.initialize(g,f,e,h,d)};var c=a.prototype;c.stageX=0;c.stageY=0;c.type=null;c.nativeEvent=null;c.onMouseMove=null;c.onMouseUp=null;c.target=null;c.initialize=function(g,f,e,h,d){this.type=g;this.stageX=f;this.stageY=e;this.target=h;this.nativeEvent=d};c.clone=function(){return new a(this.type,this.stageX,this.stageY,this.target,this.nativeEvent)};c.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"};b.MouseEvent=a}(window));(function(b){var a=function(){this.initialize()};var c=a.prototype;c.initialize=function(){};c.getBounds=function(){return new Rectangle(0,0,0,0)};c.applyFilter=function(f,e,k,h,d,j,i,g){};c.toString=function(){return"[Filter]"};c.clone=function(){return new a()};b.Filter=a}(window));(function(b){var a=function(e,d,f){this.initialize(e,d,f)};var c=a.prototype=new Filter();c.initialize=function(e,d,f){if(isNaN(e)||e<0){e=0}this.blurX=e|0;if(isNaN(d)||d<0){d=0}this.blurY=d|0;if(isNaN(f)||f<1){f=1}this.quality=f|0};c.blurX=0;c.blurY=0;c.quality=1;c.getBounds=function(){return new Rectangle(-this.blurX,-this.blurY,2*this.blurX,2*this.blurY)};c.applyFilter=function(w,D,C,d,h,z,U,S){z=z||w;if(U=null){U=D}if(S=null){S=C}try{var I=w.getImageData(D,C,d,h)}catch(Q){return false}var k=this.blurX;if(isNaN(k)||k<0){return false}k|=0;var j=this.blurY;if(isNaN(j)||j<0){return false}j|=0;if(k==0&&j==0){return false}var K=this.quality;if(isNaN(K)||K<1){K=1}K|=0;if(K>3){K=3}if(K<1){K=1}var o=I.data;var n,B,A,q,D,C,L,H,R,P,t,v,s;var f=d-1;var O=h-1;var F=k+1;var m=k+F;var E=j+1;var l=j+E;var J=1/(m*l);var G=[];var N=[];var T=[];var V=[];var u=[];var M=[];while(K-->0){s=v=0;for(C=0;C<h;C++){n=o[s]*F;B=o[s+1]*F;A=o[s+2]*F;q=o[s+3]*F;for(L=1;L<=k;L++){H=s+(((L>f?f:L))<<2);n+=o[H++];B+=o[H++];A+=o[H++];q+=o[H]}for(D=0;D<d;D++){G[v]=n;N[v]=B;T[v]=A;V[v]=q;if(C==0){u[D]=Math.min(D+F,f)<<2;M[D]=Math.max(D-k,0)<<2}R=s+u[D];P=s+M[D];n+=o[R++]-o[P++];B+=o[R++]-o[P++];A+=o[R++]-o[P++];q+=o[R]-o[P];v++}s+=(d<<2)}for(D=0;D<d;D++){t=D;n=G[t]*E;B=N[t]*E;A=T[t]*E;q=V[t]*E;for(L=1;L<=j;L++){t+=(L>O?0:d);n+=G[t];B+=N[t];A+=T[t];q+=V[t]}v=D<<2;for(C=0;C<h;C++){o[v]=(n*J+0.5)|0;o[v+1]=(B*J+0.5)|0;o[v+2]=(A*J+0.5)|0;o[v+3]=(q*J+0.5)|0;if(D==0){u[C]=Math.min(C+E,O)*d;M[C]=Math.max(C-j,0)*d}R=D+u[C];P=D+M[C];n+=G[R]-G[P];B+=N[R]-N[P];A+=T[R]-T[P];q+=V[R]-V[P];v+=d<<2}}}z.putImageData(I,U,S);return true};c.clone=function(){return new a(this.blurX,this.blurY,this.quality)};c.toString=function(){return"[BoxBlurFilter (name="+this.name+")]"};b.BoxBlurFilter=a}(window));(function(a){var b=function(e,k,i,j,h,g,d,f){this.initialize(e,k,i,j,h,g,d,f)};var c=b.prototype=new Filter();c.redMultiplier=1;c.greenMultiplier=1;c.blueMultiplier=1;c.alphaMultiplier=1;c.redOffset=0;c.greenOffset=0;c.blueOffset=0;c.alphaOffset=0;c.initialize=function(e,k,i,j,h,g,d,f){this.redMultiplier=e!=null?e:1;this.greenMultiplier=k!=null?k:1;this.blueMultiplier=i!=null?i:1;this.alphaMultiplier=j!=null?j:1;this.redOffset=h||0;this.greenOffset=g||0;this.blueOffset=d||0;this.alphaOffset=f||0};c.applyFilter=function(s,q,o,g,r,f,p,n){f=f||s;if(p=null){p=q}if(n=null){n=o}try{var d=s.getImageData(q,o,g,r)}catch(m){return false}var k=d.data;var h=k.length;for(var j=0;j<h;j+=4){k[j]=k[j]*this.redMultiplier+this.redOffset;k[j+1]=k[j+1]*this.greenMultiplier+this.greenOffset;k[j+2]=k[j+2]*this.blueMultiplier+this.blueOffset;k[j+3]=k[j+3]*this.alphaMultiplier+this.alphaOffset}d.data=k;f.putImageData(d,p,n);return true};c.toString=function(){return"[ColorFilter]"};c.clone=function(){return new b(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)};a.ColorFilter=b}(window));(function(b){var a=function(d){this.initialize(d)};var c=a.prototype=new Filter();c.matrix=null;c.initialize=function(d){this.matrix=d};c.applyFilter=function(j,n,m,d,f,k,U,S){k=k||j;if(U=null){U=n}if(S=null){S=m}try{var w=j.getImageData(n,m,d,f)}catch(Q){return false}var R=w.data;var F=R.length;var q,N,T,V;var h=this.matrix;var P=h[0],O=h[1],M=h[2],L=h[3],I=h[4];var G=h[5],D=h[6],B=h[7],z=h[8],u=h[9];var J=h[10],H=h[11],E=h[12],C=h[13],A=h[14];var v=h[15],t=h[16],s=h[17],p=h[18],o=h[19];for(var K=0;K<F;K+=4){q=R[K];N=R[K+1];T=R[K+2];V=R[K+3];R[K]=q*P+N*O+T*M+V*L+I;R[K+1]=q*G+N*D+T*B+V*z+u;R[K+2]=q*J+N*H+T*E+V*C+A;R[K+3]=q*v+N*t+T*s+V*p+o}w.data=R;k.putImageData(w,U,S);return true};c.toString=function(){return"[ColorMatrixFilter]"};c.clone=function(){return new a(this.matrix)};b.ColorMatrixFilter=a}(window));